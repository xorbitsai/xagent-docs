import path from 'path';
export const validatePathWithinCwd = (inputPath, dir) => {
    const baseDir = dir || process.cwd();
    const resolvedPath = path.resolve(baseDir, inputPath);
    const relative = path.relative(baseDir, resolvedPath);
    if (relative.startsWith(`..${path.sep}`) || relative === '..' || path.isAbsolute(relative)) {
        throw new Error(`Access denied: path: ${inputPath} is outside the current directory`);
    }
    return { resolvedPath };
};
